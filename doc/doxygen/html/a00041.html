<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nauteff auto pilot: motor.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Nauteff auto pilot
   </div>
   <div id="projectbrief">Autopilot for boat using STM32L4</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f7374e2e0880857e633dae119bf6e1b2.html">AP</a></li><li class="navelem"><a class="el" href="dir_f6024555edb91c92286789204247ac6f.html">tasks</a></li><li class="navelem"><a class="el" href="dir_aa6787a2aac31845089ef2f60137983b.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">motor.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;FreeRTOS.h&quot;</code><br />
<code>#include &quot;message_buffer.h&quot;</code><br />
<code>#include &quot;queue.h&quot;</code><br />
<code>#include &quot;semphr.h&quot;</code><br />
<code>#include &quot;task.h&quot;</code><br />
<code>#include &quot;timers.h&quot;</code><br />
<code>#include &quot;stm32l4xx_ll_bus.h&quot;</code><br />
<code>#include &quot;stm32l4xx_ll_gpio.h&quot;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stm32l452xx.h&gt;</code><br />
<code>#include &quot;<a class="el" href="a00062_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="a00056_source.html">printf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="a00050_source.html">rlib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="a00086_source.html">service.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="a00095_source.html">apdialog.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="a00098_source.html">autopilot.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="a00092_source.html">motor.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for motor.c:</div>
<div class="dyncontent">
<div class="center"><img src="a00042.png" border="0" usemap="#amotor_8c" alt=""/></div>
<map name="amotor_8c" id="amotor_8c">
<area shape="rect" title=" " alt="" coords="773,5,844,32"/>
<area shape="rect" title=" " alt="" coords="5,80,73,107"/>
<area shape="rect" title=" " alt="" coords="63,155,159,181"/>
<area shape="rect" title=" " alt="" coords="347,80,484,107"/>
<area shape="rect" title=" " alt="" coords="183,155,258,181"/>
<area shape="rect" title=" " alt="" coords="509,80,591,107"/>
<area shape="rect" title=" " alt="" coords="616,80,679,107"/>
<area shape="rect" title=" " alt="" coords="703,80,779,107"/>
<area shape="rect" title=" " alt="" coords="803,80,951,107"/>
<area shape="rect" title=" " alt="" coords="975,80,1128,107"/>
<area shape="rect" title=" " alt="" coords="1131,229,1201,256"/>
<area shape="rect" title=" " alt="" coords="1309,80,1428,107"/>
<area shape="rect" href="a00062.html" title=" " alt="" coords="283,155,337,181"/>
<area shape="rect" href="a00056.html" title=" " alt="" coords="1452,80,1520,107"/>
<area shape="rect" href="a00050.html" title=" " alt="" coords="1544,80,1599,107"/>
<area shape="rect" href="a00086.html" title=" " alt="" coords="1204,80,1285,107"/>
<area shape="rect" href="a00095.html" title=" " alt="" coords="1623,80,1714,107"/>
<area shape="rect" href="a00098.html" title=" " alt="" coords="1739,80,1831,107"/>
<area shape="rect" href="a00092.html" title=" " alt="" coords="149,80,221,107"/>
<area shape="rect" title=" " alt="" coords="1459,155,1534,181"/>
<area shape="rect" title=" " alt="" coords="1558,155,1633,181"/>
<area shape="rect" href="a00059.html" title=" " alt="" coords="1204,155,1280,181"/>
<area shape="rect" title=" " alt="" coords="1305,155,1435,181"/>
<area shape="rect" title=" " alt="" coords="1226,229,1309,256"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html">MotorData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a28df3c175713353a69f5ae59aad052df"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a28df3c175713353a69f5ae59aad052df">DBG_MOTOR_PRINT</a>(X)&#160;&#160;&#160;(X)</td></tr>
<tr class="separator:a28df3c175713353a69f5ae59aad052df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c490da336a5b0a5cc052f70875aeb1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a32c490da336a5b0a5cc052f70875aeb1">DBG_ADC_PRINT</a>(X)&#160;&#160;&#160;(X)</td></tr>
<tr class="separator:a32c490da336a5b0a5cc052f70875aeb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b866192d7b4b819d98f8141822df24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a18b866192d7b4b819d98f8141822df24">MOTOR_EVENT_STALLED</a>&#160;&#160;&#160;(0x1 &lt;&lt; 0)</td></tr>
<tr class="separator:a18b866192d7b4b819d98f8141822df24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e79b6ae157c01f2497e8c5694a60f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a44e79b6ae157c01f2497e8c5694a60f6">MOTOR_EVENT_STOP</a>&#160;&#160;&#160;(0x1 &lt;&lt; 1)</td></tr>
<tr class="separator:a44e79b6ae157c01f2497e8c5694a60f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb9e3be8846c4c12e824553d2058d63e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#adb9e3be8846c4c12e824553d2058d63e">DELTA_ANGLE_NEAR</a>&#160;&#160;&#160;(0.5F * (<a class="el" href="a00074.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.F))      /* 0.5 degree */</td></tr>
<tr class="separator:adb9e3be8846c4c12e824553d2058d63e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c0f61a7447336031042432485be4531"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a4c0f61a7447336031042432485be4531">DELTA_ANGLE_THRESHOLD</a>&#160;&#160;&#160;(0.5F * (<a class="el" href="a00074.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.F)) /* 0.5 degree */</td></tr>
<tr class="separator:a4c0f61a7447336031042432485be4531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd7c8c289e93e489d3ee473a8d230dc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#abd7c8c289e93e489d3ee473a8d230dc5">MOTOR_V_CURRENT_NONE</a>&#160;&#160;&#160;(0.F)</td></tr>
<tr class="separator:abd7c8c289e93e489d3ee473a8d230dc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c8ccb6aa8a0b8b523111c9507d5efaa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a9c8ccb6aa8a0b8b523111c9507d5efaa">MOTOR_V_CURRENT_FREE</a>&#160;&#160;&#160;(.35F)</td></tr>
<tr class="separator:a9c8ccb6aa8a0b8b523111c9507d5efaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07cee329548512811c3ae2810c754a3a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a07cee329548512811c3ae2810c754a3a">MOTOR_V_CURRENT_BLOCKED</a>&#160;&#160;&#160;(1.0F)    /*  */</td></tr>
<tr class="separator:a07cee329548512811c3ae2810c754a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae068bb96d2ffb6dbc0716405a20eae0c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#ae068bb96d2ffb6dbc0716405a20eae0c">ADC_PERIOD</a>&#160;&#160;&#160;(0.01F)   /* 100 ms */</td></tr>
<tr class="separator:ae068bb96d2ffb6dbc0716405a20eae0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a354f31906fc54407560bdc171d1de57e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a354f31906fc54407560bdc171d1de57e">MOTOR_TIME_TO_STOP</a>&#160;&#160;&#160;(0.1F)    /* 100 ms */</td></tr>
<tr class="separator:a354f31906fc54407560bdc171d1de57e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53919d7094499edb2bd432017960151f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a53919d7094499edb2bd432017960151f">MOTOR_MAX_TIME_OVERCURRENT</a>&#160;&#160;&#160;(0.02F)   /* 20 ms */</td></tr>
<tr class="separator:a53919d7094499edb2bd432017960151f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c800893e7510051b15f015988f8f8f5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a4c800893e7510051b15f015988f8f8f5">MOTOR_CVT_ANGLE_TIME</a>&#160;&#160;&#160;(10.0F)   /* Estimated conversion between time and helm move angle */</td></tr>
<tr class="separator:a4c800893e7510051b15f015988f8f8f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72e842461087a7d47759b0cf0d5086b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#ad72e842461087a7d47759b0cf0d5086b">ADC_CVT_TO_VOLTAGE</a>&#160;&#160;&#160;(0.0097F) /* Ratio ADC val. and power voltage */</td></tr>
<tr class="separator:ad72e842461087a7d47759b0cf0d5086b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0021c9725e8a23aa23eb88e2a18976c2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a0021c9725e8a23aa23eb88e2a18976c2">ADC_CVT_TO_CURRENT</a>&#160;&#160;&#160;(0.0004)  /* Ratio  ADC val. and current */</td></tr>
<tr class="separator:a0021c9725e8a23aa23eb88e2a18976c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02536d03d39d13d6eb04bf64e57af8ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a02536d03d39d13d6eb04bf64e57af8ac">MOTOR_STATUS_ENGAGED</a>&#160;&#160;&#160;(0x1 &lt;&lt; 0) /* 0 clutch out, 1 : clutch in*/</td></tr>
<tr class="separator:a02536d03d39d13d6eb04bf64e57af8ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a639f34cdf8b918588401a6ee1d055408"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a639f34cdf8b918588401a6ee1d055408">MOTOR_STATUS_MOVING_TIME</a>&#160;&#160;&#160;(0x1 &lt;&lt; 1) /* moving for time */</td></tr>
<tr class="separator:a639f34cdf8b918588401a6ee1d055408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa88cf233c357531a915cb070711f1a81"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#aa88cf233c357531a915cb070711f1a81">MOTOR_STATUS_MOVING_ANGLE</a>&#160;&#160;&#160;(0x1 &lt;&lt; 2) /* moving helm to angle */</td></tr>
<tr class="separator:aa88cf233c357531a915cb070711f1a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac58da863e26f070c1ac0625bf52305b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#ac58da863e26f070c1ac0625bf52305b6">MOTOR_STATUS_DIR_STARBOARD</a>&#160;&#160;&#160;(0x1 &lt;&lt; 3) /* moving to starboard */</td></tr>
<tr class="separator:ac58da863e26f070c1ac0625bf52305b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e553c1bf254795edabf8f5089d1d927"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a5e553c1bf254795edabf8f5089d1d927">MOTOR_STATUS_DIR_PORT</a>&#160;&#160;&#160;(0x1 &lt;&lt; 4) /* moving to port*/</td></tr>
<tr class="separator:a5e553c1bf254795edabf8f5089d1d927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01339bd10b34a4eb67ba45f5d748157c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a01339bd10b34a4eb67ba45f5d748157c">MOTOR_STATUS_IDLE</a>&#160;&#160;&#160;(0x1 &lt;&lt; 5) /* motor idle i.e. stopped */</td></tr>
<tr class="separator:a01339bd10b34a4eb67ba45f5d748157c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50421de153b29a274a884ea35afa24a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#aa50421de153b29a274a884ea35afa24a">MOTOR_STATUS_RUNNING</a>&#160;&#160;&#160;(0x1 &lt;&lt; 6) /* motor running */</td></tr>
<tr class="separator:aa50421de153b29a274a884ea35afa24a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a3de649d7387c7cd6bca53d6fcb476"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a52a3de649d7387c7cd6bca53d6fcb476">MOTOR_STATUS_STOPPING</a>&#160;&#160;&#160;(0x1 &lt;&lt; 7) /* motor stopping */</td></tr>
<tr class="separator:a52a3de649d7387c7cd6bca53d6fcb476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd6f45e6fb6ca300b2131ccc3b3d6395"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#acd6f45e6fb6ca300b2131ccc3b3d6395">MOTOR_STATUS_STALLED</a>&#160;&#160;&#160;(0x1 &lt;&lt; 8) /* motor stalled */</td></tr>
<tr class="separator:acd6f45e6fb6ca300b2131ccc3b3d6395"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0bf5334e4fe85e13ab5b9c3d2071b6f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a0bf5334e4fe85e13ab5b9c3d2071b6f8">MOTOR_MSG_letInClutch</a> (void)</td></tr>
<tr class="memdesc:a0bf5334e4fe85e13ab5b9c3d2071b6f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the order "engage clutch" to motor task.  <a href="a00041.html#a0bf5334e4fe85e13ab5b9c3d2071b6f8">More...</a><br /></td></tr>
<tr class="separator:a0bf5334e4fe85e13ab5b9c3d2071b6f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ee69017e45f41a438fd76673da6e113"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a5ee69017e45f41a438fd76673da6e113">MOTOR_MSG_letOutClutch</a> (void)</td></tr>
<tr class="memdesc:a5ee69017e45f41a438fd76673da6e113"><td class="mdescLeft">&#160;</td><td class="mdescRight">send the order disengage clutch to motor task  <a href="a00041.html#a5ee69017e45f41a438fd76673da6e113">More...</a><br /></td></tr>
<tr class="separator:a5ee69017e45f41a438fd76673da6e113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a7a0eea9f4c0a4912cb81a577d8c6ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a8a7a0eea9f4c0a4912cb81a577d8c6ce">MOTOR_MSG_setHelmAngle</a> (float angle)</td></tr>
<tr class="memdesc:a8a7a0eea9f4c0a4912cb81a577d8c6ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">send the order move angle  <a href="a00041.html#a8a7a0eea9f4c0a4912cb81a577d8c6ce">More...</a><br /></td></tr>
<tr class="separator:a8a7a0eea9f4c0a4912cb81a577d8c6ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39aba34c5e0746953b9dce97e9bc7c68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a39aba34c5e0746953b9dce97e9bc7c68">MOTOR_MSG_moveTime</a> (float time)</td></tr>
<tr class="memdesc:a39aba34c5e0746953b9dce97e9bc7c68"><td class="mdescLeft">&#160;</td><td class="mdescRight">send the order move for a time  <a href="a00041.html#a39aba34c5e0746953b9dce97e9bc7c68">More...</a><br /></td></tr>
<tr class="separator:a39aba34c5e0746953b9dce97e9bc7c68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4246cb15bb6ae30a5935f4e0df31e63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#ae4246cb15bb6ae30a5935f4e0df31e63">MOTOR_MSG_set_cvt_angle_time</a> (float cvt)</td></tr>
<tr class="separator:ae4246cb15bb6ae30a5935f4e0df31e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21b447acab649620ca700b2ca98533b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#af21b447acab649620ca700b2ca98533b">Motor_set_cvt_angle_time</a> (float cvt)</td></tr>
<tr class="separator:af21b447acab649620ca700b2ca98533b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc006e72aa64ec5140fca4b7cec3062"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#acdc006e72aa64ec5140fca4b7cec3062">Motor_newValues</a> (float deltat, float vPower, float iMotor)</td></tr>
<tr class="memdesc:acdc006e72aa64ec5140fca4b7cec3062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update motor status with new values of voltage and current.  <a href="a00041.html#acdc006e72aa64ec5140fca4b7cec3062">More...</a><br /></td></tr>
<tr class="separator:acdc006e72aa64ec5140fca4b7cec3062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48030b8ad89c4fe0abca20165c61f07f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a48030b8ad89c4fe0abca20165c61f07f">Motor_moveTime</a> (float timeToMove)</td></tr>
<tr class="memdesc:a48030b8ad89c4fe0abca20165c61f07f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move the motor for a given time.  <a href="a00041.html#a48030b8ad89c4fe0abca20165c61f07f">More...</a><br /></td></tr>
<tr class="separator:a48030b8ad89c4fe0abca20165c61f07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f8d7a96d8f202e07e1cea78ebab1223"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a1f8d7a96d8f202e07e1cea78ebab1223">Motor_setHelmAngle</a> (float angle)</td></tr>
<tr class="separator:a1f8d7a96d8f202e07e1cea78ebab1223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44dc60d14b1baa6400716426a5ad9dbb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a44dc60d14b1baa6400716426a5ad9dbb">Motor_engageTiller</a> ()</td></tr>
<tr class="separator:a44dc60d14b1baa6400716426a5ad9dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6150878b7f5297bccae651b5d85e923"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#ab6150878b7f5297bccae651b5d85e923">Motor_disengageTiller</a> ()</td></tr>
<tr class="separator:ab6150878b7f5297bccae651b5d85e923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae19d085f29c9892a207cb1610d51e3c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00032.html#a8866b5421a676559242721d47fc1fcdc">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#ae19d085f29c9892a207cb1610d51e3c8">init_taskMotor</a> ()</td></tr>
<tr class="memdesc:ae19d085f29c9892a207cb1610d51e3c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the motor task This function creates the queue.  <a href="a00041.html#ae19d085f29c9892a207cb1610d51e3c8">More...</a><br /></td></tr>
<tr class="separator:ae19d085f29c9892a207cb1610d51e3c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33e12cdfd20052a9803a45d77995b1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#aa33e12cdfd20052a9803a45d77995b1a">taskMotor</a> (void *parameters)</td></tr>
<tr class="memdesc:aa33e12cdfd20052a9803a45d77995b1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Motor control task.  <a href="a00041.html#aa33e12cdfd20052a9803a45d77995b1a">More...</a><br /></td></tr>
<tr class="separator:aa33e12cdfd20052a9803a45d77995b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20a88180db1113be1e89266917d148b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#af20a88180db1113be1e89266917d148b">HAL_ADC_ConvCpltCallback</a> (ADC_HandleTypeDef *hadc)</td></tr>
<tr class="separator:af20a88180db1113be1e89266917d148b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aac3d2c59ee0e3bbae1b99529a154eb62"><td class="memItemLeft" align="right" valign="top">TIM_HandleTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#aac3d2c59ee0e3bbae1b99529a154eb62">htim3</a></td></tr>
<tr class="separator:aac3d2c59ee0e3bbae1b99529a154eb62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf5bcf39f693387e5067b405ab08db5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00124.html">MotorData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#acf5bcf39f693387e5067b405ab08db5d">motorData</a></td></tr>
<tr class="separator:acf5bcf39f693387e5067b405ab08db5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d83db39766518000532e9a2667b57ef"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00041.html#a3d83db39766518000532e9a2667b57ef">msgQueueMotor</a> = (QueueHandle_t)0</td></tr>
<tr class="separator:a3d83db39766518000532e9a2667b57ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0021c9725e8a23aa23eb88e2a18976c2" name="a0021c9725e8a23aa23eb88e2a18976c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0021c9725e8a23aa23eb88e2a18976c2">&#9670;&nbsp;</a></span>ADC_CVT_TO_CURRENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADC_CVT_TO_CURRENT&#160;&#160;&#160;(0.0004)  /* Ratio  ADC val. and current */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad72e842461087a7d47759b0cf0d5086b" name="ad72e842461087a7d47759b0cf0d5086b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72e842461087a7d47759b0cf0d5086b">&#9670;&nbsp;</a></span>ADC_CVT_TO_VOLTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADC_CVT_TO_VOLTAGE&#160;&#160;&#160;(0.0097F) /* Ratio ADC val. and power voltage */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae068bb96d2ffb6dbc0716405a20eae0c" name="ae068bb96d2ffb6dbc0716405a20eae0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae068bb96d2ffb6dbc0716405a20eae0c">&#9670;&nbsp;</a></span>ADC_PERIOD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADC_PERIOD&#160;&#160;&#160;(0.01F)   /* 100 ms */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a32c490da336a5b0a5cc052f70875aeb1" name="a32c490da336a5b0a5cc052f70875aeb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32c490da336a5b0a5cc052f70875aeb1">&#9670;&nbsp;</a></span>DBG_ADC_PRINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DBG_ADC_PRINT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">X</td><td>)</td>
          <td>&#160;&#160;&#160;(X)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a28df3c175713353a69f5ae59aad052df" name="a28df3c175713353a69f5ae59aad052df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28df3c175713353a69f5ae59aad052df">&#9670;&nbsp;</a></span>DBG_MOTOR_PRINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DBG_MOTOR_PRINT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">X</td><td>)</td>
          <td>&#160;&#160;&#160;(X)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adb9e3be8846c4c12e824553d2058d63e" name="adb9e3be8846c4c12e824553d2058d63e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb9e3be8846c4c12e824553d2058d63e">&#9670;&nbsp;</a></span>DELTA_ANGLE_NEAR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DELTA_ANGLE_NEAR&#160;&#160;&#160;(0.5F * (<a class="el" href="a00074.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.F))      /* 0.5 degree */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4c0f61a7447336031042432485be4531" name="a4c0f61a7447336031042432485be4531"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c0f61a7447336031042432485be4531">&#9670;&nbsp;</a></span>DELTA_ANGLE_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DELTA_ANGLE_THRESHOLD&#160;&#160;&#160;(0.5F * (<a class="el" href="a00074.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.F)) /* 0.5 degree */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4c800893e7510051b15f015988f8f8f5" name="a4c800893e7510051b15f015988f8f8f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c800893e7510051b15f015988f8f8f5">&#9670;&nbsp;</a></span>MOTOR_CVT_ANGLE_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_CVT_ANGLE_TIME&#160;&#160;&#160;(10.0F)   /* Estimated conversion between time and helm move angle */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a18b866192d7b4b819d98f8141822df24" name="a18b866192d7b4b819d98f8141822df24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b866192d7b4b819d98f8141822df24">&#9670;&nbsp;</a></span>MOTOR_EVENT_STALLED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_EVENT_STALLED&#160;&#160;&#160;(0x1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a44e79b6ae157c01f2497e8c5694a60f6" name="a44e79b6ae157c01f2497e8c5694a60f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44e79b6ae157c01f2497e8c5694a60f6">&#9670;&nbsp;</a></span>MOTOR_EVENT_STOP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_EVENT_STOP&#160;&#160;&#160;(0x1 &lt;&lt; 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a53919d7094499edb2bd432017960151f" name="a53919d7094499edb2bd432017960151f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53919d7094499edb2bd432017960151f">&#9670;&nbsp;</a></span>MOTOR_MAX_TIME_OVERCURRENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_MAX_TIME_OVERCURRENT&#160;&#160;&#160;(0.02F)   /* 20 ms */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5e553c1bf254795edabf8f5089d1d927" name="a5e553c1bf254795edabf8f5089d1d927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e553c1bf254795edabf8f5089d1d927">&#9670;&nbsp;</a></span>MOTOR_STATUS_DIR_PORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_DIR_PORT&#160;&#160;&#160;(0x1 &lt;&lt; 4) /* moving to port*/</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac58da863e26f070c1ac0625bf52305b6" name="ac58da863e26f070c1ac0625bf52305b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac58da863e26f070c1ac0625bf52305b6">&#9670;&nbsp;</a></span>MOTOR_STATUS_DIR_STARBOARD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_DIR_STARBOARD&#160;&#160;&#160;(0x1 &lt;&lt; 3) /* moving to starboard */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a02536d03d39d13d6eb04bf64e57af8ac" name="a02536d03d39d13d6eb04bf64e57af8ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02536d03d39d13d6eb04bf64e57af8ac">&#9670;&nbsp;</a></span>MOTOR_STATUS_ENGAGED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_ENGAGED&#160;&#160;&#160;(0x1 &lt;&lt; 0) /* 0 clutch out, 1 : clutch in*/</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a01339bd10b34a4eb67ba45f5d748157c" name="a01339bd10b34a4eb67ba45f5d748157c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01339bd10b34a4eb67ba45f5d748157c">&#9670;&nbsp;</a></span>MOTOR_STATUS_IDLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_IDLE&#160;&#160;&#160;(0x1 &lt;&lt; 5) /* motor idle i.e. stopped */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa88cf233c357531a915cb070711f1a81" name="aa88cf233c357531a915cb070711f1a81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa88cf233c357531a915cb070711f1a81">&#9670;&nbsp;</a></span>MOTOR_STATUS_MOVING_ANGLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_MOVING_ANGLE&#160;&#160;&#160;(0x1 &lt;&lt; 2) /* moving helm to angle */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a639f34cdf8b918588401a6ee1d055408" name="a639f34cdf8b918588401a6ee1d055408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a639f34cdf8b918588401a6ee1d055408">&#9670;&nbsp;</a></span>MOTOR_STATUS_MOVING_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_MOVING_TIME&#160;&#160;&#160;(0x1 &lt;&lt; 1) /* moving for time */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa50421de153b29a274a884ea35afa24a" name="aa50421de153b29a274a884ea35afa24a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa50421de153b29a274a884ea35afa24a">&#9670;&nbsp;</a></span>MOTOR_STATUS_RUNNING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_RUNNING&#160;&#160;&#160;(0x1 &lt;&lt; 6) /* motor running */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acd6f45e6fb6ca300b2131ccc3b3d6395" name="acd6f45e6fb6ca300b2131ccc3b3d6395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd6f45e6fb6ca300b2131ccc3b3d6395">&#9670;&nbsp;</a></span>MOTOR_STATUS_STALLED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_STALLED&#160;&#160;&#160;(0x1 &lt;&lt; 8) /* motor stalled */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a52a3de649d7387c7cd6bca53d6fcb476" name="a52a3de649d7387c7cd6bca53d6fcb476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52a3de649d7387c7cd6bca53d6fcb476">&#9670;&nbsp;</a></span>MOTOR_STATUS_STOPPING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_STATUS_STOPPING&#160;&#160;&#160;(0x1 &lt;&lt; 7) /* motor stopping */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a354f31906fc54407560bdc171d1de57e" name="a354f31906fc54407560bdc171d1de57e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a354f31906fc54407560bdc171d1de57e">&#9670;&nbsp;</a></span>MOTOR_TIME_TO_STOP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_TIME_TO_STOP&#160;&#160;&#160;(0.1F)    /* 100 ms */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a07cee329548512811c3ae2810c754a3a" name="a07cee329548512811c3ae2810c754a3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07cee329548512811c3ae2810c754a3a">&#9670;&nbsp;</a></span>MOTOR_V_CURRENT_BLOCKED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_V_CURRENT_BLOCKED&#160;&#160;&#160;(1.0F)    /*  */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9c8ccb6aa8a0b8b523111c9507d5efaa" name="a9c8ccb6aa8a0b8b523111c9507d5efaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c8ccb6aa8a0b8b523111c9507d5efaa">&#9670;&nbsp;</a></span>MOTOR_V_CURRENT_FREE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_V_CURRENT_FREE&#160;&#160;&#160;(.35F)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abd7c8c289e93e489d3ee473a8d230dc5" name="abd7c8c289e93e489d3ee473a8d230dc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd7c8c289e93e489d3ee473a8d230dc5">&#9670;&nbsp;</a></span>MOTOR_V_CURRENT_NONE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOTOR_V_CURRENT_NONE&#160;&#160;&#160;(0.F)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="af20a88180db1113be1e89266917d148b" name="af20a88180db1113be1e89266917d148b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af20a88180db1113be1e89266917d148b">&#9670;&nbsp;</a></span>HAL_ADC_ConvCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HAL_ADC_ConvCpltCallback </td>
          <td>(</td>
          <td class="paramtype">ADC_HandleTypeDef *&#160;</td>
          <td class="paramname"><em>hadc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae19d085f29c9892a207cb1610d51e3c8" name="ae19d085f29c9892a207cb1610d51e3c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae19d085f29c9892a207cb1610d51e3c8">&#9670;&nbsp;</a></span>init_taskMotor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00032.html#a8866b5421a676559242721d47fc1fcdc">int</a> init_taskMotor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the motor task This function creates the queue. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00041_ae19d085f29c9892a207cb1610d51e3c8_icgraph.png" border="0" usemap="#aa00041_ae19d085f29c9892a207cb1610d51e3c8_icgraph" alt=""/></div>
<map name="aa00041_ae19d085f29c9892a207cb1610d51e3c8_icgraph" id="aa00041_ae19d085f29c9892a207cb1610d51e3c8_icgraph">
<area shape="rect" title="Initialise the motor task This function creates the queue." alt="" coords="124,5,240,32"/>
<area shape="rect" href="a00035.html#a3ecc3c4ea937a5d2e86bd65848aa2551" title=" " alt="" coords="5,5,76,32"/>
</map>
</div>

</div>
</div>
<a id="ab6150878b7f5297bccae651b5d85e923" name="ab6150878b7f5297bccae651b5d85e923"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6150878b7f5297bccae651b5d85e923">&#9670;&nbsp;</a></span>Motor_disengageTiller()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Motor_disengageTiller </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a44dc60d14b1baa6400716426a5ad9dbb" name="a44dc60d14b1baa6400716426a5ad9dbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44dc60d14b1baa6400716426a5ad9dbb">&#9670;&nbsp;</a></span>Motor_engageTiller()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Motor_engageTiller </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a48030b8ad89c4fe0abca20165c61f07f" name="a48030b8ad89c4fe0abca20165c61f07f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48030b8ad89c4fe0abca20165c61f07f">&#9670;&nbsp;</a></span>Motor_moveTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Motor_moveTime </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>timeToMove</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Move the motor for a given time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeToMove</td><td>Time to move in seconds, positive to port, negative to stbd If motor is running for a specified time in the same direction as timeToMove, it sets the time to move to timeToMove; </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a0bf5334e4fe85e13ab5b9c3d2071b6f8" name="a0bf5334e4fe85e13ab5b9c3d2071b6f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bf5334e4fe85e13ab5b9c3d2071b6f8">&#9670;&nbsp;</a></span>MOTOR_MSG_letInClutch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_MSG_letInClutch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the order "engage clutch" to motor task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td>Motor task stops motor if it is running and engage clutch. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00041_a0bf5334e4fe85e13ab5b9c3d2071b6f8_icgraph.png" border="0" usemap="#aa00041_a0bf5334e4fe85e13ab5b9c3d2071b6f8_icgraph" alt=""/></div>
<map name="aa00041_a0bf5334e4fe85e13ab5b9c3d2071b6f8_icgraph" id="aa00041_a0bf5334e4fe85e13ab5b9c3d2071b6f8_icgraph">
<area shape="rect" title="Send the order &quot;engage clutch&quot; to motor task." alt="" coords="377,5,563,32"/>
<area shape="rect" href="a00044.html#a9d6276b9ad0b1f218e4db68ca0dd5a62" title=" " alt="" coords="160,5,329,32"/>
<area shape="rect" href="a00044.html#a93b9cf91f7623d6d8b100a3693d6d5e4" title=" " alt="" coords="5,5,112,32"/>
</map>
</div>

</div>
</div>
<a id="a5ee69017e45f41a438fd76673da6e113" name="a5ee69017e45f41a438fd76673da6e113"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ee69017e45f41a438fd76673da6e113">&#9670;&nbsp;</a></span>MOTOR_MSG_letOutClutch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_MSG_letOutClutch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>send the order disengage clutch to motor task </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td>Motor task release clutch and stops motor if it is running. Task motor sends a message later when motor is stopped if it was moving. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00041_a5ee69017e45f41a438fd76673da6e113_icgraph.png" border="0" usemap="#aa00041_a5ee69017e45f41a438fd76673da6e113_icgraph" alt=""/></div>
<map name="aa00041_a5ee69017e45f41a438fd76673da6e113_icgraph" id="aa00041_a5ee69017e45f41a438fd76673da6e113_icgraph">
<area shape="rect" title="send the order disengage clutch to motor task" alt="" coords="349,5,545,32"/>
<area shape="rect" href="a00044.html#af6663ef3860cc9454511614ab488900a" title="Set Idle mode." alt="" coords="160,5,301,32"/>
<area shape="rect" href="a00044.html#a93b9cf91f7623d6d8b100a3693d6d5e4" title=" " alt="" coords="5,5,112,32"/>
</map>
</div>

</div>
</div>
<a id="a39aba34c5e0746953b9dce97e9bc7c68" name="a39aba34c5e0746953b9dce97e9bc7c68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39aba34c5e0746953b9dce97e9bc7c68">&#9670;&nbsp;</a></span>MOTOR_MSG_moveTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_MSG_moveTime </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>send the order move for a time </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>to move in seconds counterclockwise if negative, clockwise if positive Used to move helm when not in auto mode. Task motor send a message when move done. Previous move order for time is discarded if motor was running same direction. Move order is ignored if if motor is running oposite direction. Used for moving continuously with repeated pushes on button. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00041_a39aba34c5e0746953b9dce97e9bc7c68_icgraph.png" border="0" usemap="#aa00041_a39aba34c5e0746953b9dce97e9bc7c68_icgraph" alt=""/></div>
<map name="aa00041_a39aba34c5e0746953b9dce97e9bc7c68_icgraph" id="aa00041_a39aba34c5e0746953b9dce97e9bc7c68_icgraph">
<area shape="rect" title="send the order move for a time" alt="" coords="280,5,465,32"/>
<area shape="rect" href="a00044.html#a601303505481aa87ba2050ac8c6ef504" title="Turn helm or change direction to steer." alt="" coords="160,5,232,32"/>
<area shape="rect" href="a00044.html#a93b9cf91f7623d6d8b100a3693d6d5e4" title=" " alt="" coords="5,5,112,32"/>
</map>
</div>

</div>
</div>
<a id="ae4246cb15bb6ae30a5935f4e0df31e63" name="ae4246cb15bb6ae30a5935f4e0df31e63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4246cb15bb6ae30a5935f4e0df31e63">&#9670;&nbsp;</a></span>MOTOR_MSG_set_cvt_angle_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_MSG_set_cvt_angle_time </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>cvt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00041_ae4246cb15bb6ae30a5935f4e0df31e63_icgraph.png" border="0" usemap="#aa00041_ae4246cb15bb6ae30a5935f4e0df31e63_icgraph" alt=""/></div>
<map name="aa00041_ae4246cb15bb6ae30a5935f4e0df31e63_icgraph" id="aa00041_ae4246cb15bb6ae30a5935f4e0df31e63_icgraph">
<area shape="rect" title=" " alt="" coords="485,5,728,32"/>
<area shape="rect" href="a00038.html#a3f7d4dcd2a607f34d7e03a65a208501f" title="parse_command_line: Parses a single command line (terminated by a newline) from standard input." alt="" coords="276,5,437,32"/>
<area shape="rect" href="a00038.html#aa8cb42729b2ad233b7308cfd229df56d" title=" " alt="" coords="124,5,228,32"/>
<area shape="rect" href="a00035.html#a3ecc3c4ea937a5d2e86bd65848aa2551" title=" " alt="" coords="5,5,76,32"/>
</map>
</div>

</div>
</div>
<a id="a8a7a0eea9f4c0a4912cb81a577d8c6ce" name="a8a7a0eea9f4c0a4912cb81a577d8c6ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a7a0eea9f4c0a4912cb81a577d8c6ce">&#9670;&nbsp;</a></span>MOTOR_MSG_setHelmAngle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_MSG_setHelmAngle </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>angle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>send the order move angle </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">angle</td><td>to move radians clockwise if positive, counterclockwise if negative </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The direction to steer is usually indicated clockwise. </dd>
<dd>
To turn starboard, i.e. right, helm has to be moved to port and vice versa.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00041_a8a7a0eea9f4c0a4912cb81a577d8c6ce_icgraph.png" border="0" usemap="#aa00041_a8a7a0eea9f4c0a4912cb81a577d8c6ce_icgraph" alt=""/></div>
<map name="aa00041_a8a7a0eea9f4c0a4912cb81a577d8c6ce_icgraph" id="aa00041_a8a7a0eea9f4c0a4912cb81a577d8c6ce_icgraph">
<area shape="rect" title="send the order move angle" alt="" coords="331,5,537,32"/>
<area shape="rect" href="a00044.html#afa8c4bb9dc2009e2a7dee4f0e290c8c5" title=" " alt="" coords="160,5,283,32"/>
<area shape="rect" href="a00044.html#a93b9cf91f7623d6d8b100a3693d6d5e4" title=" " alt="" coords="5,5,112,32"/>
</map>
</div>

</div>
</div>
<a id="acdc006e72aa64ec5140fca4b7cec3062" name="acdc006e72aa64ec5140fca4b7cec3062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdc006e72aa64ec5140fca4b7cec3062">&#9670;&nbsp;</a></span>Motor_newValues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t Motor_newValues </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>vPower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>iMotor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update motor status with new values of voltage and current. </p>
<p >This function updates the motor status with new values of voltage and current and stops or start th motor. It is called by taskMotor when it receives new ADC values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">deltat</td><td>Time since last call in seconds </td></tr>
    <tr><td class="paramname">vPower</td><td>Voltage of power supply </td></tr>
    <tr><td class="paramname">iMotor</td><td>Current through motor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="af21b447acab649620ca700b2ca98533b" name="af21b447acab649620ca700b2ca98533b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af21b447acab649620ca700b2ca98533b">&#9670;&nbsp;</a></span>Motor_set_cvt_angle_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Motor_set_cvt_angle_time </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>cvt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1f8d7a96d8f202e07e1cea78ebab1223" name="a1f8d7a96d8f202e07e1cea78ebab1223"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f8d7a96d8f202e07e1cea78ebab1223">&#9670;&nbsp;</a></span>Motor_setHelmAngle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Motor_setHelmAngle </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>angle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa33e12cdfd20052a9803a45d77995b1a" name="aa33e12cdfd20052a9803a45d77995b1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33e12cdfd20052a9803a45d77995b1a">&#9670;&nbsp;</a></span>taskMotor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void taskMotor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>parameters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Motor control task. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00041_aa33e12cdfd20052a9803a45d77995b1a_cgraph.png" border="0" usemap="#aa00041_aa33e12cdfd20052a9803a45d77995b1a_cgraph" alt=""/></div>
<map name="aa00041_aa33e12cdfd20052a9803a45d77995b1a_cgraph" id="aa00041_aa33e12cdfd20052a9803a45d77995b1a_cgraph">
<area shape="rect" title="Motor control task." alt="" coords="5,31,93,57"/>
<area shape="rect" href="a00050.html#aa383452fe445bfae989358c9d7d96f4f" title=" " alt="" coords="176,5,235,32"/>
<area shape="rect" href="a00032.html#aca9a2b5d52ea7cb385abffb611d72361" title=" " alt="" coords="141,56,269,83"/>
<area shape="rect" href="a00005.html#a14879a103e26f4046753802aae30b3ee" title="Gets the available space in the buffer." alt="" coords="525,31,689,57"/>
<area shape="rect" href="a00005.html#a04fc040a6bc37c6e937941834355e74a" title="Gets the next contiguous block of data available for reading." alt="" coords="317,107,477,133"/>
<area shape="rect" href="a00005.html#a01aef86db943a39b165b5f2596c0ac97" title="Writes data to the ring buffer." alt="" coords="345,56,450,83"/>
<area shape="rect" href="a00005.html#ae7d2b03a35849ef3608478c60275ee98" title="Checks if the buffer is empty." alt="" coords="545,107,670,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00041_aa33e12cdfd20052a9803a45d77995b1a_icgraph.png" border="0" usemap="#aa00041_aa33e12cdfd20052a9803a45d77995b1a_icgraph" alt=""/></div>
<map name="aa00041_aa33e12cdfd20052a9803a45d77995b1a_icgraph" id="aa00041_aa33e12cdfd20052a9803a45d77995b1a_icgraph">
<area shape="rect" title="Motor control task." alt="" coords="124,5,212,32"/>
<area shape="rect" href="a00035.html#a3ecc3c4ea937a5d2e86bd65848aa2551" title=" " alt="" coords="5,5,76,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aac3d2c59ee0e3bbae1b99529a154eb62" name="aac3d2c59ee0e3bbae1b99529a154eb62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac3d2c59ee0e3bbae1b99529a154eb62">&#9670;&nbsp;</a></span>htim3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TIM_HandleTypeDef htim3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acf5bcf39f693387e5067b405ab08db5d" name="acf5bcf39f693387e5067b405ab08db5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf5bcf39f693387e5067b405ab08db5d">&#9670;&nbsp;</a></span>motorData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00124.html">MotorData</a> motorData</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"> </div>
<div class="line">    .status =  (0x1 &lt;&lt; 5)  ,</div>
<div class="line"> </div>
<div class="line">    .helmAngleRequested = 0.F,</div>
<div class="line">    .HelmAngleEstimated = 0.F,</div>
<div class="line">    .turnTimeReq = 0.F,</div>
<div class="line">    .turnTimeRemaining = 0.F,</div>
<div class="line"> </div>
<div class="line">    .vcurrentNone =  (0.F) ,</div>
<div class="line">    .vcurrentFree =  (.35F) ,</div>
<div class="line">    .vcurrentBlocked =  (1.0F)  ,</div>
<div class="line">    .timeStartStop = 0.1F,</div>
<div class="line">    .currentStalled = 1.0F,</div>
<div class="line">    .cvt_angle_time =  (10.0F)  ,</div>
<div class="line"> </div>
<div class="line">    .vPowerStandard = 12.F,</div>
<div class="line">    .vPowerMin = 10.,</div>
<div class="line">    .vPowerMax = 15.F,</div>
<div class="line">    .vPower = 0.F,</div>
<div class="line">    .vCurrent = 0.F</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d83db39766518000532e9a2667b57ef" name="a3d83db39766518000532e9a2667b57ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d83db39766518000532e9a2667b57ef">&#9670;&nbsp;</a></span>msgQueueMotor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t msgQueueMotor = (QueueHandle_t)0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
